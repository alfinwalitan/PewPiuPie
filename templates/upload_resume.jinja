{% extends "base_pelamar.jinja" %}

{% block title %}Upload Resume{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/upload_resume.css') }}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
{% endblock %}

{% block content %}
<main class="upload-container">
    <h2>Upload Your Resume</h2>

    <div class="form-section">
        <label for="resumeUpload">Upload Resume</label>
        <input
            type="file"
            id="resumeUpload"
            name="resumeUpload"
            accept=".pdf, .doc, .docx"
        />
        <button type="button" class="insert-button" id="insertResumeBtn">
            <i class="fa-solid fa-upload"></i> Insert Resume
        </button>
    </div>

    <div class="form-section">
        <label for="uploadedFiles">Uploaded Files</label>
        <div id="uploadedFiles"></div>
    </div>

    <div class="form-section">
        <label for="gdriveLink">Other Files (Google Drive Folder Link):</label>
        <input type="text" id="gdriveLink" name="gdriveLink" placeholder="Google Drive Folder Link">
    </div>

    <div class="form-section upload-button-container">
        <button class="upload-button">Upload</button>
    </div>

    <script>
        const insertBtn = document.getElementById('insertResumeBtn');
        const fileInput = document.getElementById('resumeUpload');
        const uploadedFilesContainer = document.getElementById('uploadedFiles');

        insertBtn.addEventListener('click', () => {
            fileInput.click();
        });

        fileInput.addEventListener('change', () => {
            uploadedFilesContainer.innerHTML = '';

            if (fileInput.files.length > 0) {
                const fileName = fileInput.files[0].name;

                const fileEntry = document.createElement('div');
                fileEntry.classList.add('uploaded-file-entry');
                fileEntry.textContent = fileName + ' ';

                const clearBtn = document.createElement('button');
                clearBtn.classList.add('clear-button');
                clearBtn.textContent = 'âœ–';
                clearBtn.title = 'Remove selected file';

                clearBtn.addEventListener('click', () => {
                    fileInput.value = '';
                    uploadedFilesContainer.innerHTML = '';
                });

                fileEntry.appendChild(clearBtn);
                uploadedFilesContainer.appendChild(fileEntry);
            }
        });
    </script>
</main>
{% endblock %}
