{% extends "base_pelamar.jinja" %}

{% block title %}Upload Resume{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='upload_resume.css') }}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
{% endblock %}

{% block content %}
<main class="upload-container">
    <h2>Upload Your Resume</h2>

    <!-- Upload Resume Section -->
    <div class="form-section">
        <label for="resumeUpload">Upload Resume</label>

        <input
            type="file"
            id="resumeUpload"
            name="resumeUpload"
            accept=".pdf, .doc, .docx"
            style="display: none;"
        />

        <button type="button" class="insert-button" id="insertResumeBtn">
            <i class="fa-solid fa-upload"></i> Insert Resume
        </button>
    </div>

    <div class="form-section">
        <label for="uploadedFiles">Uploaded Files</label>
        <div id="uploadedFiles"></div>
    </div>

    <div class="form-section">
        <label for="gdriveLink">Other Files (Google Drive Folder Link):</label>
        <input type="text" id="gdriveLink" name="gdriveLink" placeholder="Google Drive Folder Link">
    </div>

    <div class="form-section upload-button-container">
        <button class="upload-button">Upload</button>
    </div>

    <script>
      const insertBtn = document.getElementById('insertResumeBtn');
      const fileInput = document.getElementById('resumeUpload');
      const uploadedFilesContainer = document.getElementById('uploadedFiles');

      insertBtn.addEventListener('click', () => {
        fileInput.click();
      });

      fileInput.addEventListener('change', () => {
        uploadedFilesContainer.innerHTML = ''; // Clear previous file

        if (fileInput.files.length > 0) {
          const fileName = fileInput.files[0].name;

          const fileEntry = document.createElement('div');
          fileEntry.style.marginTop = '8px';
          fileEntry.style.fontStyle = 'italic';
          fileEntry.style.color = '#555';
          fileEntry.textContent = fileName + ' ';

          const clearBtn = document.createElement('button');
          clearBtn.textContent = 'âœ–';
          clearBtn.title = 'Remove selected file';
          clearBtn.style.background = 'none';
          clearBtn.style.border = 'none';
          clearBtn.style.cursor = 'pointer';
          clearBtn.style.color = '#888';
          clearBtn.style.fontSize = '18px';
          clearBtn.style.padding = '0';

          clearBtn.addEventListener('mouseenter', () => clearBtn.style.color = '#e00');
          clearBtn.addEventListener('mouseleave', () => clearBtn.style.color = '#888');

          clearBtn.addEventListener('click', () => {
            fileInput.value = '';
            uploadedFilesContainer.innerHTML = '';
          });

          fileEntry.appendChild(clearBtn);
          uploadedFilesContainer.appendChild(fileEntry);
        }
      });
    </script>
</main>
{% endblock %}
